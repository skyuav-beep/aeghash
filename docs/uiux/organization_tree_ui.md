# 조직도 뷰 UI 프로토타입 가이드 (v0.1)

## 1. 목적 및 시나리오
- 관리자(Admin)가 유니레벨/바이너리 조직 구조를 빠르게 탐색하고 노드별 KPI를 확인하도록 지원한다.
- 신규 회원 배치, 직급 검토, 보너스 지급 상태 확인 등 운영 의사결정을 위한 정보 구조를 정의한다.
- 후속 프론트엔드 구현(React + Canvas/WebGL/DOM 혼합)에 필요한 인터랙션·토큰·상태 규칙을 문서화한다.

### 주요 사용자 여정
1. 특정 회원 검색 → 트리 기준점 이동 → 좌/우 하위 조직 규모 확인.
2. 스필오버 배치 현황 모니터링 → 대기열 처리 필요 노드 식별.
3. 노드 상세 패널에서 PV 추이, 보너스 지급 통계, 직급 이력 조회.

## 2. 레이아웃 개요
- **3분할 구조**
  - 좌측: `조직 필터 패널`(폭 280px) — 트리 타입 전환, 직급/센터 필터.
  - 중앙: `캔버스 영역`(유동 폭·높이) — 노드 그래프, 줌/팬 가능.
  - 우측: `정보 패널`(폭 340px) — 선택 노드 상세, 액션 버튼.
- 헤더(높이 64px): 뷰 제목, 검색 입력, 시각화 옵션 토글(그리드/레벨).
- 하단 상태바(높이 40px): 현재 레벨·노드 수·실패 큐 카운트 표시.

```
┌────────────────────────────────────────────────────────────┐
│ 헤더                                                        │
├───────────────┬───────────────────────────────┬──────────────┤
│ 필터 패널     │             캔버스             │  정보 패널    │
│ (좌측 고정)   │         (팬/줌 영역)           │ (선택 노드)   │
├───────────────┴───────────────────────────────┴──────────────┤
│ 상태바                                                     │
└────────────────────────────────────────────────────────────┘
```

## 3. 캔버스 인터랙션
- **렌더링 방식**: 기본 SVG + DOM 혼합, 1,500 노드 이상 시 WebGL 전환 고려.
- **줌/팬**
  - 줌 범위: 0.4x ~ 2.5x (`ctrl/meta + scroll`, 터치핀치).
  - 팬: 클릭 드래그 또는 트랙패드 스크롤. 키보드 `←↑↓→` ±Shift(빠른 이동).
  - 미니맵(우측 하단 160x120px) 제공, 현재 뷰 영역 표시 및 이동 지원.
- **노드 레이아웃**
  - 유니레벨: 방향 `Top → Bottom`, 각 레벨 간 수직 간격 96px.
  - 바이너리: `Root → 좌/우` 균등 분기, 수평 간격 120px, 스필오버 방향(좌 우 순) 화살표 제공.
  - 노드 최소 크기 120x64px, 직급 배지와 KPI 요약 포함.
- **선택/포커스**
  - 단일 클릭: 노드 선택 → 정보 패널 갱신, 노드 테두리 `colors.palette.primary`.
  - 더블 클릭: 해당 노드를 루트로 재배치(recenter).
  - Shift+클릭: 다중 선택(최대 5개) → 일괄 액션(예: 메시지 전송).
- **애니메이션**
  - 노드 확장/축소 200ms ease-out.
  - prefers-reduced-motion 활성 시 애니메이션 80ms로 축소, 투명도 전환만 사용.

## 4. 정보 패널 구성
- 헤더: 노드 이름 + 직급 배지 + 상태 아이콘(활성/보류/위험).
- KPI 섹션(카드 3개)
  1. `일 PV`: 오늘 기준 PV, 전일 대비 증감(퍼센트).
  2. `좌/우 볼륨`: 좌/우 PV, 스필오버 대기열 카운트.
  3. `보너스 누적`: 주간 보너스 금액, 보류 금액.
- 탭 구조
  - `개요`: 가입일, 스폰서/후원자, 센터 정보.
  - `직급 이력`: 최근 6개월 타임라인.
  - `보너스`: 최근 10건 지급/보류 로그 테이블.
- 액션 버튼
  - Primary: `보너스 세부 보기` (보너스 화면 딥링크).
  - Secondary: `노드 고정` (북마크), `대기열 수동 배치`.
- 접근성: 탭 전환 `aria-controls`, KPI 카드 `role=group` + 설명 텍스트 제공.

## 5. 필터 패널
- 필터 그룹
  1. 트리 선택: Toggle (`유니레벨`, `바이너리`).
  2. 조직 범위: 루트 선택 드롭다운(검색 가능), 북마크 노드 리스트.
  3. 직급/상태 필터: 체크박스 그룹, `전체/활성/보류/위험`.
  4. 기간 선택: PV/보너스 KPI 기준(오늘/7일/30일/사용자 지정).
- 적용 로직: 변경 시 `적용` 버튼 활성화, 클릭 → 캔버스 데이터 리패치.
- 필터 요약: 헤더에 Chip 표시(`직급: Platinum`, `상태: 위험` 등).

## 6. 상태 관리
- **로딩**
  - 캔버스: 그리드 배경 + 스켈레톤 노드(회색 박스).
  - 정보 패널: Skeleton card 3개, 0.6s shimmer.
- **데이터 없음**
  - 메시지: "선택한 조건에 해당하는 조직 노드가 없습니다."
  - CTA: `필터 초기화` Secondary 버튼.
- **에러**
  - 캔버스 중앙에 경고 아이콘 + "조직 데이터를 불러오지 못했습니다." + `재시도`.
  - 상태바에 에러 배지 표시.
- **대기열 경고**
  - 스필오버 대기열 50건 이상 시 상단 알림 배너(경고 색상) 노출.

## 7. 디자인 토큰 매핑
- 배경: `colors.surface.canvas` (`#FFFFFF` 기본, 다크모드 `#101010`).
- 노드 카드
  - 테두리: 기본 `colors.border.subtle`, 포커스 `colors.palette.primary`.
  - 직급 배지: `colors.status.success` / `warning` / `danger`.
  - 이름 타이포: `typography.subtitle.lg`, KPI 값 `typography.data.large`.
- 미니맵: 박스 그림자 `shadow.overlay.md`, 선택 영역 `colors.palette.primary_light`.
- 상태바: 배경 `colors.surface.subtle`, 텍스트 `colors.text.muted`.

## 8. 반응형 규칙
- Desktop(≥1280px): 기본 3분할 유지.
- Tablet(768~1279px): 정보 패널이 Bottom Sheet(높이 40vh)로 전환, 필터 패널은 Drawer.
- Mobile(≤767px): 캔버스 전체폭 → 노드 카드 리스트 뷰 fallback(트리 깊이 2단계까지 Accordion).
- 줌 제스처: 터치 기기에서 핀치 줌, 더블탭 줌인(1.2x).

## 9. 접근성 & QA 체크리스트
- 키보드 탭 순서: 헤더 → 필터 → 캔버스 미니맵 → 노드 포커스 → 정보 패널.
- 화면 리더: 노드 요소에 `aria-label="회원명, 직급, 좌/우 PV"` 구조화 제공.
- 대비: 노드 테두리 대비 3:1 이상, 배지 텍스트 4.5:1 이상.
- QA 시나리오
  1. 1,000+ 노드 렌더링 시 FPS 50 이상 유지.
  2. 스필오버 큐 폭주 상태에서 경고 배너 노출 확인.
  3. prefers-reduced-motion 환경에서 애니메이션 최소화.
  4. 모바일 fallback 리스트에서 노드 상세 전환 동작 검증.

## 10. 후속 작업
- Figma 프로토타입(`Admin/OrganizationTree`) 업데이트 및 인터랙션 파트너 검수.
- 스토리북 POC: 캔버스 Mock 데이터 + 노드 카드 컴포넌트 Story 작성.
- 백엔드 연동: `GET /admin/organizations/tree` API 스펙 확정 후 데이터 바인딩.
